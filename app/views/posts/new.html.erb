<h1>Posts#new</h1>
<p>Find me in app/views/posts/new.html.erb</p>


<% if @post.errors.any? %>
<ul>
    <% @post.errors.full_messages.each do |message| %>
    <li><%= message %></li>
    <% end %>
</ul>
<% end %>

<%= form_for @post,:url => {controller: "posts", action: "create"} do |f| %>

<div class="field">
    <%= f.label :title, "タイトル" %><br />
    <%= f.text_field :title, placeholder: "必須です" %>
</div>

<div class="field">
    <%= f.label :artist, "アーティスト名" %><br />
    <%= f.text_field :artist %>
</div>

<div class="field">
    <%= f.label :song, "曲名" %><br />
    <%= f.text_field :song %>
</div>


<script>
    function func_id() {
        var i = document.getElementById("ytid");
        var t = i.value;
        if (/watch\?v=/.test(t)) {
            var index = t.indexOf('watch?v=');
            i.value = t.slice(index + 8);
        } else if (/youtu\.be\//.test(t)) {
            var index = t.indexOf('youtu.be/');
            i.value = t.slice(index + 9);
        } else {
            i.value = '正しいURLを入力してください';
        }
    }
</script>

<div class="field">
    <%= f.label :ytid, "動画URL" %><br />
    <%= f.text_field :ytid, placeholder: "必須です", oninput: "func_id()", id: "ytid" %>
    <p>YouTubeのURLをペーストしてください</p>
</div>


<div class="field">
    <%= f.label :comment, "コメント" %><br />
    <%= f.text_area :comment %>
</div>

<div class="actions">
    <%= f.submit "投稿" %>
</div>

<% end %>