<% if @profile.errors.any? %>
<ul>
    <% @profile.errors.full_messages.each do |message| %>
    <li><%= message %></li>
    <% end %>
</ul>
<% end %>

<%= form_for @profile,:url => {controller: "profiles", action: "edit"} do |f| %>

<div class="field">
    <%= f.label :sns_t, "Twitter" %>
    <%= f.text_field :sns_t, placeholder: "URL" %>
</div>

<div class="field">
    <%= f.label :sns_f, "Facebook" %>
    <%= f.text_field :sns_f, placeholder: "URL" %>
</div>

<div class="field">
    <%= f.label :sns_i, "Instagram" %>
    <%= f.text_field :sns_i, placeholder: "URL" %>
</div>

<div class="field">
    <%= f.label :sns_l, "Line" %>
    <%= f.text_field :sns_l, placeholder: "URL" %>
</div>

<div class="field">
    <%= f.label :userlink, "Link" %>
    <%= f.text_field :userlink, placeholder: "URL" %>
</div>

<div class="field">
    <%= f.label :trendartist, "最近ハマっているアーティストは？" %>
    <%= f.text_area :trendartist, placeholder: "Trend artist" %>
</div>

<div class="field">
    <%= f.label :trendsong, "最近ハマっている曲は？" %>
    <%= f.text_area :trendsong, placeholder: "Trend song" %>
</div>

<div class="field">
    <%= f.label :fvcate, "好きなジャンルは？" %>
    <%= f.text_field :fvcate, placeholder: "Trend genre" %>
</div>

<div class="field">
    <%= f.label :fvartist, "好きなアーティストは？" %>
    <%= f.text_area :fvartist, placeholder: "Favorite artist" %>
</div>

<div class="field">
    <%= f.label :fvsong, "好きな曲は？" %>
    <%= f.text_area :fvsong, placeholder: "Favorite artist" %>
</div>



<div class="field">
    <%= f.label :fvmv, "好きなMVは？" %>
    <%= f.text_field :fvmv, placeholder: "YouTubeのURLをペースト", oninput: "func_id()", id: "ytid" %>
    <p id="yt_error"></p>

    <% if @profile.fvmv.present? %>
    <div id="ytid_confirm_now">
        <iframe width="854" height="480" src="https://www.youtube.com/embed/<%= @profile.fvmv %>" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </div>
    <% end %>

    <div id="ytid_confirm"></div>
</div>

<script>
    function func_id() {
        var i = document.getElementById("ytid");
        var t = i.value;

        $('#ytid_confirm, #ytid_confirm_now, #yt_error').fadeOut();

        if (/watch\?v=/.test(t)) {
            var index = t.indexOf('watch?v=');
            var y = t.slice(index + 8);

            i.value = y

            var ytid_confirm = '<iframe width="854" height="480" src="https://www.youtube.com/embed/' + y + '" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>';
            document.getElementById('ytid_confirm').innerHTML = ytid_confirm;
            $('#ytid_confirm').fadeIn();

        } else if (/youtu\.be\//.test(t)) {
            var index = t.indexOf('youtu.be/');
            var y = t.slice(index + 9);

            i.value = y

            var ytid_confirm = '<iframe width="854" height="480" src="https://www.youtube.com/embed/' + y + '" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>';
            document.getElementById('ytid_confirm').innerHTML = ytid_confirm;
            $('#ytid_confirm').fadeIn();

        } else {
            i.value = '';
            document.getElementById('yt_error').innerHTML = "正しいURLを入力してください"
            $('#yt_error').fadeIn();
        }
    }
</script>

<p class="s_ttl">どんな音楽史を歩みましたか？</p>

<div class="field">
    <%= f.text_field :h_year1, placeholder: "1990", class: "year" %>年
    <%= f.text_area :h_content1, placeholder: "ハマっていた音楽やエピソードは？" %>
</div>

<div class="field">
    <%= f.text_field :h_year2,  placeholder: "1990", class: "year" %>年
    <%= f.text_area :h_content2, placeholder: "ハマっていた音楽やエピソードは？" %>
</div>

<div class="field">
    <%= f.text_field :h_year3, placeholder: "1990", class: "year" %>年
    <%= f.text_area :h_content3, placeholder: "ハマっていた音楽やエピソードは？" %>
</div>

<div class="field">
    <%= f.text_field :h_year4, placeholder: "1990", class: "year" %>年
    <%= f.text_area :h_content4, placeholder: "ハマっていた音楽やエピソードは？" %>
</div>

<div class="field">
    <%= f.text_field :h_year5, placeholder: "1990", class: "year" %>年
    <%= f.text_area :h_content5, placeholder: "ハマっていた音楽やエピソードは？" %>
</div>

<div class="actions">
    <%= f.submit "更新" %>
</div>

<% end %>